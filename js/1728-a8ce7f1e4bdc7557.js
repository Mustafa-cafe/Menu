"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1728],{1584:function(e,t,r){r.d(t,{Hi:function(){return s},WY:function(){return a},be:function(){return c},y3:function(){return n}});var n=400,a=401,s=404,c=500},5307:function(e,t,r){r.d(t,{Z:function(){return p}});var n=r(2262),a=r(2777),s=r(1531),c=r(3553),o=r(7247),u=r(6576),i=r(1584),p=function(e){(0,s.Z)(ApiException,e);var t,r=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=(0,o.Z)(ApiException);if(t){var n=(0,o.Z)(this).constructor;e=Reflect.construct(r,arguments,n)}else e=r.apply(this,arguments);return(0,c.Z)(this,e)});function ApiException(e,t,n){var s;return(0,a.Z)(this,ApiException),(s=r.call(this,e||"Internal server error")).name=s.constructor.name,s.statusCode=t||i.be,s.payload=n||{},s}return(0,n.Z)(ApiException)}((0,u.Z)(Error))},1728:function(e,t,r){r.d(t,{Z:function(){return m}});var n=r(6835),a=r(29),s=r(2262),c=r(2777),o=r(9499),u=r(7794),i=r.n(u),p=r(7584),l=r(236),d=r(9071),f=r(1584),h=r(5307),v=r(5566),m=(0,s.Z)(function Api(e){var t,r,s,u,m,y,Z,g,x,w,b,_,k,S,I,O,C=this;(0,c.Z)(this,Api),(0,o.Z)(this,"getHeader",(0,a.Z)(i().mark(function _callee(){var e;return i().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,C.get("/api/v2/header");case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}},_callee)}))),(0,o.Z)(this,"getProducts",(0,a.Z)(i().mark(function _callee2(){var e;return i().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,C.get("/api/v2/product/list");case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}},_callee2)}))),(0,o.Z)(this,"getProduct",(t=(0,a.Z)(i().mark(function _callee3(e){var t;return i().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,C.get("/api/v2/product/".concat(e));case 2:return t=r.sent,r.abrupt("return",t.data);case 4:case"end":return r.stop()}},_callee3)})),function(e){return t.apply(this,arguments)})),(0,o.Z)(this,"getPage",(r=(0,a.Z)(i().mark(function _callee4(e){var t;return i().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,C.get("/api/v2/page/".concat(e));case 2:return t=r.sent,r.abrupt("return",t.data);case 4:case"end":return r.stop()}},_callee4)})),function(e){return r.apply(this,arguments)})),(0,o.Z)(this,"getQrHubSettings",(s=(0,a.Z)(i().mark(function _callee5(e){var t;return i().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,C.get("/api/v2/".concat(e,"/settings"));case 2:return t=r.sent,r.abrupt("return",t.data);case 4:case"end":return r.stop()}},_callee5)})),function(e){return s.apply(this,arguments)})),(0,o.Z)(this,"getSitemapData",(0,a.Z)(i().mark(function _callee6(){var e;return i().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,C.get("/api/v2/sitemap/show");case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}},_callee6)}))),(0,o.Z)(this,"getPaymentData",(u=(0,a.Z)(i().mark(function _callee7(e){var t;return i().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,C.get("/api/v2/payment/params?uuid=".concat(e));case 2:return t=r.sent,r.abrupt("return",t.data);case 4:case"end":return r.stop()}},_callee7)})),function(e){return u.apply(this,arguments)})),(0,o.Z)(this,"addClient",(m=(0,a.Z)(i().mark(function _callee8(e){var t,r,n,a;return i().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t=e.name,r=e.phone,n=e.shopCountry,s.next=3,C.modernPost("/api/v2/client",{name:t,phone:r,shopCountry:n});case 3:return a=s.sent,s.abrupt("return",a);case 5:case"end":return s.stop()}},_callee8)})),function(e){return m.apply(this,arguments)})),(0,o.Z)(this,"createOrder",(y=(0,a.Z)(i().mark(function _callee9(e){var t,r,n,a,s,c,o,u,p,f,h,m,y;return i().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.clientId,r=e.cart,n=e.spotId,a=e.address,s=e.address2,c=e.addressComment,o=e.comment,u=e.deliveryType,p=e.paymentType,f=e.deliveryTime,h=e.lat,m=e.lng,y=!1,i.prev=2,i.next=5,C.modernPost("/api/v2/order",{client_id:t,cart:r,spot_id:n,address:a,address2:s,address_comment:c,comment:o,delivery_type:u,payment_type:p,delivery_time:f,lat:h,lng:m});case 5:y=i.sent,i.next=12;break;case 8:throw i.prev=8,i.t0=i.catch(2),v.ZP.error("Front create order error",i.t0,{clientId:t,cart:r,spotId:n,address:a,address2:s,addressComment:c,comment:o,deliveryType:u,paymentType:p,deliveryTime:f,lat:h,lng:m}),Error("Create order error");case 12:return v.ZP.log("Front Create order",{clientId:t,cart:r,spotId:n,address:a,address2:s,addressComment:c,comment:o,deliveryType:u,paymentType:p,deliveryTime:f,cartInStorage:l.Z.get(d.O6)||{},clientInStorage:l.Z.get(d.Uh)||{}}),i.abrupt("return",y);case 14:case"end":return i.stop()}},_callee9,null,[[2,8]])})),function(e){return y.apply(this,arguments)})),(0,o.Z)(this,"getTableData",(Z=(0,a.Z)(i().mark(function _callee10(e){var t;return i().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,C.get("/api/v2/".concat(e,"/table"));case 3:return t=r.sent,r.abrupt("return",t.data);case 7:if(r.prev=7,r.t0=r.catch(0),!(r.t0 instanceof h.Z)){r.next=16;break}if(r.t0.statusCode!==f.WY){r.next=12;break}return r.abrupt("return",{exists:!0,anonymous:!0});case 12:if(r.t0.statusCode!==f.Hi){r.next=14;break}return r.abrupt("return",{exists:!1,anonymous:!1});case 14:r.next=17;break;case 16:throw r.t0;case 17:case"end":return r.stop()}},_callee10,null,[[0,7]])})),function(e){return Z.apply(this,arguments)})),(0,o.Z)(this,"getQrPaymentData",(g=(0,a.Z)(i().mark(function _callee11(e){var t,r,n,a,s,c,o,u,p,l,d,f,h;return i().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.tableHash,r=e.orderId,n=e.amount,a=e.tips,s=e.userId,c=e.serviceCharge,o=e.productIds,i.next=3,C.post("/api/v2/".concat(t,"/order/payment"),{tableHash:t,orderId:r,amount:n,tips:a,userId:s,serviceCharge:c,productIds:o});case 3:return p=(u=i.sent).paymentId,l=u.paymentData,d=u.paymentStatus,f=u.provider,h=u.canTip,i.abrupt("return",{provider:f,paymentId:p,paymentData:l,paymentStatus:d,canTip:h});case 10:case"end":return i.stop()}},_callee11)})),function(e){return g.apply(this,arguments)})),(0,o.Z)(this,"getQrPaymentStatus",(x=(0,a.Z)(i().mark(function _callee12(e,t){var r;return i().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,C.get("/api/v2/".concat(e,"/order/payment/").concat(t));case 2:return r=n.sent.payment,n.abrupt("return",null==r?void 0:r.status);case 5:case"end":return n.stop()}},_callee12)})),function(e,t){return x.apply(this,arguments)})),(0,o.Z)(this,"createReview",(w=(0,a.Z)(i().mark(function _callee13(e,t){var r;return i().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,C.post("/api/v2/".concat(e,"/reviews/create"),t);case 2:return r=n.sent,n.abrupt("return",r);case 4:case"end":return n.stop()}},_callee13)})),function(e,t){return w.apply(this,arguments)})),(0,o.Z)(this,"prepareRequest",function(e){var t,r,n=C.domain;return(0,p.jU)()?(r="".concat(window.location.origin).concat(e),t={DOMAIN:window.location.hostname}):(r="".concat("http://shop-api.poster-b2c.svc.cluster.local").concat(e),t={DOMAIN:n,HOST:n}),[t,r]}),(0,o.Z)(this,"get",(b=(0,a.Z)(i().mark(function _callee14(e){var t,r,a,s,c,o,u,p,l;return i().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t=C.prepareRequest(e),a=(r=(0,n.Z)(t,2))[0],s=r[1],i.prev=1,i.next=4,fetch(s,{headers:a});case 4:return c=i.sent,i.next=7,c.json();case 7:o=i.sent,i.next=13;break;case 10:throw i.prev=10,i.t0=i.catch(1),new h.Z("Error occurred while fetching data from SHOP API",null===(u=c)||void 0===u?void 0:u.status,{method:"GET",headers:a,url:s,error:i.t0});case 13:if(!(c.status>=f.y3)){i.next=15;break}throw new h.Z(null===(p=o)||void 0===p?void 0:p.message,null===(l=c)||void 0===l?void 0:l.status,{method:"GET",headers:a,url:s,json:o});case 15:return i.abrupt("return",o);case 16:case"end":return i.stop()}},_callee14,null,[[1,10]])})),function(e){return b.apply(this,arguments)})),(0,o.Z)(this,"modernGet",(_=(0,a.Z)(i().mark(function _callee15(e){var t,r,a,s,c;return i().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return t=C.prepareRequest(e),a=(r=(0,n.Z)(t,2))[0],s=r[1],o.next=3,fetch(s,{headers:a});case 3:return c=o.sent,o.t0=c.ok,o.t1=c.status,o.next=8,c.json();case 8:return o.t2=o.sent,o.abrupt("return",{ok:o.t0,status:o.t1,json:o.t2});case 10:case"end":return o.stop()}},_callee15)})),function(e){return _.apply(this,arguments)})),(0,o.Z)(this,"modernPost",(k=(0,a.Z)(i().mark(function _callee16(e,t){var r,a,s,c,o;return i().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return r=C.prepareRequest(e),s=(a=(0,n.Z)(r,2))[0],c=a[1],Object.assign(s||{},{"Content-Type":"application/json"}),u.next=4,fetch(c,{headers:s,body:JSON.stringify(t),method:"POST"});case 4:return o=u.sent,u.t0=o.ok,u.t1=o.status,u.next=9,o.json();case 9:return u.t2=u.sent,u.abrupt("return",{ok:u.t0,status:u.t1,json:u.t2});case 11:case"end":return u.stop()}},_callee16)})),function(e,t){return k.apply(this,arguments)})),(0,o.Z)(this,"post",(S=(0,a.Z)(i().mark(function _callee17(e,t){var r,a,s,c,o;return i().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(r=C.prepareRequest(e),s=(a=(0,n.Z)(r,2))[0],c=a[1],Object.assign(s||{},{"Content-Type":"application/json"}),!(-1!==c.indexOf("/api/v1/order/create"))){u.next=4;break}return u.abrupt("return",C.CreateOrderPost(s,c,t));case 4:return u.next=6,fetch(c,{headers:s,body:JSON.stringify(t),method:"POST"});case 6:return o=u.sent,u.abrupt("return",o.json());case 8:case"end":return u.stop()}},_callee17)})),function(e,t){return S.apply(this,arguments)})),(0,o.Z)(this,"CreateOrderPost",(I=(0,a.Z)(i().mark(function _callee18(e,t,r){var n;return i().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n={success:!1},Object.assign(e||{},{"Content-Type":"application/json"}),a.prev=2,a.next=5,fetch(t,{headers:e,body:JSON.stringify(r),method:"POST"});case 5:return n=a.sent,a.abrupt("return",n.json());case 9:a.prev=9,a.t0=a.catch(2),v.ZP.error("Create order exception",{e:a.t0,headers:e,body:r});case 12:return a.abrupt("return",n);case 13:case"end":return a.stop()}},_callee18,null,[[2,9]])})),function(e,t,r){return I.apply(this,arguments)})),(0,o.Z)(this,"getSiteInfo",(O=(0,a.Z)(i().mark(function _callee19(e){var t,r;return i().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=Array.isArray(e)?e.join(","):"",n.next=3,C.get("/api/v2/site/info?items=".concat(t));case 3:return r=n.sent,n.abrupt("return",r.data);case 5:case"end":return n.stop()}},_callee19)})),function(e){return O.apply(this,arguments)})),(0,p.jU)()||(this.domain=e.domain)})},236:function(e,t,r){r.d(t,{Z:function(){return o}});var n=r(2777),a=r(2262),s=r(9071),c=[],o=function(){function Storage(){(0,n.Z)(this,Storage)}return(0,a.Z)(Storage,null,[{key:"isAvailable",value:function(){try{return localStorage.setItem(s.$I,"1"),localStorage.removeItem(s.$I),!0}catch(e){return!1}}},{key:"set",value:function(e,t){"object"==typeof t&&(t=JSON.stringify(t)),this.isAvailable()?localStorage.setItem(e,t):c[e]=t;var r={key:e,value:JSON.parse(t)},n=new CustomEvent("customStorage",{detail:r});window.dispatchEvent(n)}},{key:"get",value:function(e){var t;if("string"==typeof(t=this.isAvailable()?localStorage.getItem(e):c[e]))try{t=JSON.parse(t)}catch(e){console.error("Storage.get JSON parse error",t)}return t}},{key:"remove",value:function(e){this.isAvailable()?localStorage.removeItem(e):delete c[e]}}]),Storage}()}}]);
//# sourceMappingURL=1728-a8ce7f1e4bdc7557.js.map